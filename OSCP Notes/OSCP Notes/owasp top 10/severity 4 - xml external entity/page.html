<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Severity 4 - XML External Entity</title>
</head><body><ul><li><b>XML External Entity (XXE): - </b></li>
<li>It abuses features of XML parsers/data(features) in order to interact with any backend systems that the application itself can access.</li>
<li>Can cause DOS or SSRF inducing the web application to make requests to other applications.</li>
<li>XXE may even enable port scanning and lead to remote code execution.</li>
<li><img src="image.png" /></li>
<li>Two Types:-</li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">1. In- Band - An in-band XXE attack is the one in which the attacker can receive an immediate response to the XXE payload.</li>
<li style="list-style-type: none">2. Out of band - out-of-band XXE attacks (also called blind XXE), there is no immediate response from the web application and attacker has to reflect the output of their XXE payload to some other file or their own server.</li>
</ul>
</li>
</ul>
<b>- Details about XML:-</b><br/>
1. It is markup language that prepares the structure and design for the data, basically used for representation of the data on a webpage or mobile app page. These are presentational languages and it doesn’t include any kind of logic or algorithm<br/>
2. Platform and programming language Independent and case sensitive.<br/>
3. XML allows validation using DTD and Schema to ensure that the XML document is free from any syntax error.<br/>
4. doesn’t require any conversion when transferred between different systems.<br/>
5. Every XML document mostly starts with XML Prolog - <b>&lt;?xml version="1.0" encoding="UTF-8"?&gt; - </b>It specifies XML version and encoding used.<b><br/>
</b>6. Every XML document must contain a `ROOT` element. <br/>
7. In the above example the &lt;mail&gt; is the ROOT element of that document and &lt;to&gt;, &lt;from&gt;, &lt;subject&gt;, &lt;text&gt; are the children elements. <img src="image 2.png" /><br/>
<br/>
<br/>
<b>DTD in XML:-</b><ul><li>DTD stands for Document Type Definition that defines the structure and the legal elements and attributes of an XML document.</li>
<li>!DOCTYPE is used to define root element.</li>
<li>!ELEMENT is used to define new element.</li>
<li>!ENTITY is used to define new entity.</li>
<li>#PCDATA means parseable character data.</li>
</ul>
<br/>
<b>XXE PAYLOAD:-</b><ul><li><img src="image 3.png" /></li>
<li>By default, the private key is stored in ~/. ssh/id_rsa within your user’s home directory</li>
</ul>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
</body></html>